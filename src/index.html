<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Travel Time</title>
  <style>
    body { margin:0; font-family: system-ui, Arial, sans-serif; background:#111; color:#eee; }
    #appShell { display:flex; flex-direction:row; height:100vh; width:100vw; overflow:hidden; }
    #leftColumn { width:360px; max-width:40%; min-width:280px; background:#1c1c1c; display:flex; flex-direction:column; border-right:1px solid #2d2d2d; overflow-y:auto; overscroll-behavior:contain; scrollbar-gutter:stable; }
    #leftColumn:focus { outline:none; box-shadow:0 0 0 2px #333 inset; } /* фокус для пульта/клавиатуры */
    header { padding: 10px 14px; background:#222; font-size: 18px; flex:0 0 auto; }
    #panel { padding: 8px 12px; flex:0 0 auto; }
    /* убран внутренний скролл, пусть прокручивается родитель */
    #foodPanel { padding:8px 12px; background:#242424; flex:0 0 auto; }
    #map { flex:1 1 auto; height:100%; background:#000; position:relative; }
    .error { color: #ff6b6b; }
    .warn { color: #ffa94d; }
    .row { margin-bottom:4px; }
    .loading { animation: pulse 1.2s infinite; }
    @keyframes pulse { 0% { opacity:.4;} 50% {opacity:1;} 100%{opacity:.4;} }
    .panel-title { font-weight:600; margin:4px 0 6px; }
    .restaurant-item { font-size:14px; margin:4px 0; line-height:1.3; }
    .cluster-meta { font-size:12px; opacity:.65; margin:4px 0 8px; }
    #gmapsShare { padding:8px 12px; background:#222; display:none; text-align:center; }
    #gmapsShare img { max-width:140px; display:block; margin:6px 0 4px; }
    /* Center QR pair content */
    .qr-pair { display:flex; gap:8px; justify-content:center; }
    .qr-box { flex:0 0 auto; text-align:center; background:#1f1f1f; border:1px solid #303030; border-radius:4px; padding:6px; margin:0 auto; }
    .qr-box img { max-width:120px; margin:4px auto; display:block; }
    .qr-box small { display:block; font-size:10px; opacity:.6; word-break:break-word; }
    #apptPanel { padding:8px 12px; background:#262626; display:none; }
    .appt-field { font-size:14px; margin:4px 0; }
    /* Optional тонкие скроллбары для WebKit */
    #leftColumn::-webkit-scrollbar { width:8px; }
    #leftColumn::-webkit-scrollbar-track { background:#1c1c1c; }
    #leftColumn::-webkit-scrollbar-thumb { background:#333; border-radius:4px; }
    #leftColumn::-webkit-scrollbar-thumb:hover { background:#444; }
  </style>
</head>
<body>
  <div id="appShell">
    <div id="leftColumn" tabindex="0" aria-label="Side information panel">
      <header>Travel Time</header>
      <div id="panel">
        <div id="status" class="row loading">Initializing…</div>
        <div id="summary" class="row"></div>
      </div>
      <div id="gmapsShare" class="row"></div>
      <div id="apptPanel" class="row"></div>
      <div id="foodPanel" class="row" style="display:none"></div>
    </div>
    <div id="map"></div>
  </div>
  <script>
    window.__PUBLIC_BASE_URL__="__PUBLIC_BASE_URL__";
    (function(){
      function send(p){
        try{ if(navigator.sendBeacon){ navigator.sendBeacon('/api/jslog',new Blob([JSON.stringify(p)],{type:'application/json'})); } else { fetch('/api/jslog',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(p)}); } }catch(e){}
      }
      window.addEventListener('error',function(e){
        send({ message:e.message, source:e.filename, lineno:e.lineno, colno:e.colno, stack:e.error&&e.error.stack, ua:navigator.userAgent, timestamp:new Date().toISOString() });
      });
      window.addEventListener('unhandledrejection',function(e){
        send({ message:'unhandledrejection:'+(e.reason&&e.reason.message||e.reason), stack:e.reason&&e.reason.stack, ua:navigator.userAgent, timestamp:new Date().toISOString() });
      });
    })();
    // Автофокус на левую панель при загрузке (для навигации стрелками на приставке)
    window.addEventListener('DOMContentLoaded', () => {
      const lc = document.getElementById('leftColumn');
      if (lc) {
        try { lc.focus(); } catch(_) {}
      }
    });
  </script>
  <script type="module" src="/static/main.js?v=5&debug=true"></script>
  <script id="gmaps-script-template" type="application/json">{"key":"__GOOGLE_MAPS_API_KEY__"}</script>
</body>
</html>
