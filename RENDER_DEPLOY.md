# Деплой на Render

## Подготовка к деплою

Ваш проект готов к деплою на Render! У вас есть:
- ✅ Dockerfile для контейнеризации
- ✅ package.json с правильными скриптами
- ✅ Express.js сервер с health endpoint
- ✅ Переменные окружения настроены

## Пошаговая инструкция деплоя

### 1. Получите Google Maps API Key
1. Перейдите в [Google Cloud Console](https://console.cloud.google.com/)
2. Создайте новый проект или выберите существующий
3. Включите следующие API:
   - Maps JavaScript API
   - Directions API
   - Distance Matrix API
   - Places API
   - Geocoding API
4. Создайте API ключ в разделе "Credentials"
5. Ограничьте ключ по доменам и API для безопасности

### 2. Создание приложения на Render

1. Перейдите на [Render Dashboard](https://dashboard.render.com/web/new?newUser=true)
2. Нажмите "New +" → "Web Service"
3. Подключите ваш GitHub репозиторий `sensey007/travel-time-webapp`
4. Выберите ветку `main`

### 3. Настройка сервиса

**Основные настройки:**
- **Name**: `travel-time-webapp` (или любое имя по вашему выбору)
- **Runtime**: `Docker`
- **Build Command**: (оставить пустым, Dockerfile все сделает)
- **Start Command**: (оставить пустым, Dockerfile все сделает)

**Переменные окружения (Environment Variables):**
```
MAPS_API_KEY=ваш_google_maps_api_ключ
NODE_ENV=production
PORT=3000
LOG_LEVEL=info
RATE_LIMIT_MAX=30
```

### 4. Дополнительные настройки

**Plan**: Выберите подходящий план:
- **Free**: Для тестирования (с ограничениями)
- **Starter**: $7/месяц для продакшена

**Auto-Deploy**: Включите для автоматического деплоя при пуше в main

### 5. Деплой

1. Нажмите "Create Web Service"
2. Render автоматически:
   - Склонирует ваш репозиторий
   - Построит Docker образ
   - Развернет приложение
   - Предоставит URL для доступа

### 6. Проверка деплоя

После успешного деплоя проверьте:
- Health endpoint: `https://your-app.onrender.com/healthz`
- Основное приложение: `https://your-app.onrender.com/`
- API endpoints: `https://your-app.onrender.com/api/directions`

## Возможные проблемы и решения

### 1. Ошибка "Server missing MAPS_API_KEY"
- Убедитесь, что переменная `MAPS_API_KEY` правильно настроена в Render
- Проверьте, что API ключ действителен и имеет нужные разрешения

### 2. Приложение не запускается
- Проверьте логи в Render Dashboard
- Убедитесь, что порт 3000 доступен (Render автоматически назначает PORT)

### 3. Медленная загрузка
- Это нормально для бесплатного плана Render
- Рассмотрите upgrade до платного плана для лучшей производительности

## Мониторинг и логи

Render предоставляет:
- **Logs**: Просмотр логов приложения в реальном времени
- **Metrics**: Мониторинг производительности
- **Health checks**: Автоматическая проверка состояния приложения

## Обновление приложения

Для обновления приложения:
1. Внесите изменения в код
2. Запушьте изменения в GitHub: `git push origin main`
3. Render автоматически пересоберет и развернет новую версию

## Дополнительные настройки

### Кастомный домен
1. В настройках сервиса перейдите в "Custom Domains"
2. Добавьте ваш домен
3. Настройте DNS записи согласно инструкциям Render

### SSL сертификат
Render автоматически предоставляет SSL сертификаты для всех приложений.

## Поддержка

Если возникли проблемы:
- Проверьте [документацию Render](https://render.com/docs)
- Изучите логи приложения в Dashboard
- Убедитесь, что все переменные окружения настроены правильно
